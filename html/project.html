<!doctype html>
<html lang="ru">

<head>
  <title>Проект</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS v5.0.2 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" href="..\css\stylesProjectPage.css">

  <style>
    #cover {
      position: fixed;
      height: 100%;
      width: 100%;
      top: 0;
      left: 0;
      background: #fff;
      z-index: 9999;
    }
  </style>

</head>

<body id="bodyId">
  <div id="cover"></div>

  <script src="../scriptsjs/fetchScripts.js"></script>
  <script type="text/javascript">
    checkToken()
      .then((status) => {
        if (status == false) throw new Error('Ошибочный запрос');
      })
      .then(async () => {        
        await LoadProjectInformation(sessionStorage.getItem('tokenOfProject'));
        $("#cover").hide();
      })
      .catch(error => { document.location.href = "authorization.html"; });
  </script>

  <header>
    <nav class="navbar">
      <div class="container-fluid">
        <a href="project_bank.html">Банк проектных предложений</a>
        <a href="account.html">Личный кабинет</a>
      </div>
    </nav>
  </header>

  <div class="containter-fluid">
    <div id="board" class="row-my row flex-nowrap">
      <div id="addColumn" class="add-column">
        <!-- кнопка создать колонку -->
        <button id="add-column-btn" class="add-column-btn" aria-expanded="false"
          onclick="removeClass('create-column', 'display-none')">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true"
            class="octicon octicon-plus">
            <path fill-rule="evenodd"
              d="M7.75 2a.75.75 0 01.75.75V7h4.25a.75.75 0 110 1.5H8.5v4.25a.75.75 0 11-1.5 0V8.5H2.75a.75.75 0 010-1.5H7V2.75A.75.75 0 017.75 2z">
            </path>
          </svg>
          Добавить колонку
        </button>
      </div>
    </div>
  </div>

  <!-- Sidebar -->
  <aside class="d-none d-md-block">
    <div class="container-fluid">
      <div class="form">
        <input id="nameOfProject" type="text" onclick="this.select();" class="form-control" id="nameOfProject"
          placeholder="Название проекта">
        <input id="inputStatus" type="text" disabled class="form-control" placeholder="Статус проекта">
        <button type="button" data-bs-toggle="modal" data-bs-target="#statusSelect" class="button">Изменить
          статус</button>
      </div>
    </div>
    <ul>
      <li id="userCaptain">Капитан: </li>
      <li id="projectManager">Преподователь: </li>
    </ul>
  </aside>

  <!-- Модальное окно с выбором статуса -->
  <div class="modal fade" id="statusSelect" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header text-center">
          <h5 class="modal-title w-100" id="exampleModalLabel">Изменить статус</h5>
        </div>
        <div class="modal-body">
          <div class="container-fluid">
            <div class="form-check">
              <input class="form-check-input" type="radio" name="flexRadioStatus" id="flexRadioInProcess"
                value="В процессе">
              <label for="flexRadioInProcess">В процессе</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="flexRadioStatus" id="flexRadioStop"
                value="Приостановлен">
              <label for="flexRadioStop">Приостановлен</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="flexRadioStatus" id="flexRadioDone" value="Завершён">
              <label for="flexRadioDone">Завершён</label>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="saveStatusbtn" onclick="SaveStatusFunction()" type="button" class="align-items-center button"
            data-bs-dismiss="modal">Сохранить</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Модальное окно создать стадию -->
  <div id="create-column" class="create-column display-none">
    <div class="form-column">
      <div class="form-header">
        <h3 class="name">Добавить стадию</h3>
        <button class="form-close" type="button" aria-label="Close dialog"
          onclick="addClass('create-column', 'display-none')">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true"
            class="octicon octicon-x">
            <path fill-rule="evenodd"
              d="M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z">
            </path>
          </svg>
        </button>
      </div>
      <div class="content">
        <h4 class="name">Имя колонки</h4>
        <input id="nameColum" type="text" class="input_text" name="" value="">
        <button id="createColumn" type="submit" data-view-component="true"
          class="create-column-btn flex-auto btn-primary btn" onclick="addClass('create-column', 'display-none')">
          Создать колонку
        </button>
      </div>
    </div>
  </div>

  <!-- окно карти -->
  <div id="card" class="card display-none">
    <div class="form-card">
      <div class="header">
        <div class="info">
          <h3 id="nameCard" class="name">Название</h3>
          <p id="inColumn">В этапе</p>
        </div>
        <div class="close">
          <button type="button" name="close" class="button" onclick="addClass('card', 'display-none')">x</button>
        </div>
        <div class="last-change">
          <p id="lastData">Последнее изменение: lastData</p>
          <p id="lastUser">Изменил: lastUser</p>
        </div>
      </div>
      <div class="content">
        <div class="mode">
          <button id="viewingCardContents" type="button" name="viewing"
            onclick="viewingContentCard(this.parentNode.parentNode)" disabled>Содержание</button>
          <button id="changeCardContents" type="button" name="change"
            onclick="eidtContentCard(this.parentNode.parentNode)">Изменить</button>
        </div>
        <div class="filling">
          <textarea disabled="true"></textarea>
        </div>
      </div>
      <div class="actions">
        <h4>Действия</h4>
        <button type="button" name="estimate" onclick="removeClass('form-estimate', 'display-none')">Оценить</button>
        <button type="button" name="max_estimate" onclick="removeClass('form-max-estimate', 'display-none')">Поставить
          макс оценку</button>
        <button type="button" name="status" onclick="removeClass('form-status', 'display-none')">Измениьт
          статус</button>
        <button type="button" name="delete" onclick="removeClass('form-delete', 'display-none')">Удалить</button>
      </div>
      <div class="comments">
        <h4>Коментарии</h4>
        <div class="new">
          <textarea name="comment" rows="3" required></textarea>
          <button id="sendComment" type="button" name="sendСomment" class="btn"
            onclick="addComent(this.parentNode)">Отправить</button>
        </div>
        <div id="commentList" class="old">
          <template id="tempComment">
            <div class="elem-comment">
              <div class="info-comment">
                <a id="userCommen">кто</a>
                <data id="dataComment">дата</data>
              </div>
              <div class="content-comment">
                <p id="contentComment">текст коментария</p>
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>

    <!-- окно оценки -->
    <div id="form-estimate" class="form-estimate display-none">
      <div class="header">
        <h3>Оценить карточку</h3>
        <button type="button" name="close" class="button" onclick="addClass('form-estimate', 'display-none')">x</button>
      </div>
      <div class="estimate">
        <input type="text" name="" placeholder="Оценка">
        <button type="button" name="button">Сохранить</button>
      </div>
    </div>

    <!-- окно максимальной оценки -->
    <div id="form-max-estimate" class="form-max-estimate display-none">
      <div class="header">
        <h3>Оценить карточку</h3>
        <button type="button" name="close" class="button"
          onclick="addClass('form-max-estimate', 'display-none')">x</button>
      </div>
      <div class="estimate">
        <input type="text" name="" placeholder="Максимальная оценка">
        <button type="button" name="button">Сохранить</button>
      </div>
    </div>

    <!-- окно изменения статуса -->
    <div id="form-status" class="form-status display-none">
      <div class="header">
        <h3>Изменить статус</h3>
        <button type="button" name="close" class="button" onclick="addClass('form-status', 'display-none')">x</button>
      </div>
      <div class="status">
        <div>
          <input id="In_process" type="radio" name="" value="В процессе"> <label for="In_process"> В процессе</label>
        </div>
        <div>
          <input id="On_inspection" type="radio" name="" value="На проверке"> <label for="On_inspection"> На
            проверке</label>
        </div>
        <div>
          <input id="Completed" type="radio" name="" value="Завершён"> <label for="Completed"> Завершён</label>
        </div>
      </div>
    </div>

    <!-- окно удаления карточки -->
    <div id="form-delete" class="form-delete display-none">
      <div class="header">
        <h3>Удалить?</h3>
      </div>
      <div class="delete">
        <button type="button" name="button">ДА</button>
        <button type="button" name="button" onclick="addClass('form-delete', 'display-none')">НЕТ</button>
      </div>
    </div>
  </div>

  <div id="showCardContaier"></div>

  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
    integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
    crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
    integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
    crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="../scriptsjs/scriptsProjectPage.js"></script>
  <script src="../scriptsjs/scriptCard.js"></script>
  <script src="../scriptsjs/fetchScripts.js"></script>
</body>

</html>